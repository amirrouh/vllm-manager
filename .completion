# VLLM Manager Bash Completion
# Source this file before using the vllm command: source .completion

_vllm_completion() {
    local cur prev opts
    COMPREPLY=()
    cur="${COMP_WORDS[COMP_CWORD]}"
    prev="${COMP_WORDS[COMP_CWORD-1]}"
    
    opts="add list start stop remove status cleanup force ui manager"
    
    if [[ ${cur} == -* ]] ; then
        case "${prev}" in
            add)
                COMPREPLY=( $(compgen -W "--port --priority --gpu-memory --max-len --tensor-parallel" -- ${cur}) )
                return 0
                ;;
            *)
                ;;
        esac
    else
        case "${prev}" in
            vllm|./vllm)
                COMPREPLY=( $(compgen -W "${opts}" -- ${cur}) )
                return 0
                ;;
            start|stop|remove)
                # Get model names from config if it exists
                if [[ -f "models_config.json" ]]; then
                    local models=$(python3 -c "import json; print(' '.join([m['name'] for m in json.load(open('models_config.json', 'r'))]))" 2>/dev/null || echo "")
                    COMPREPLY=( $(compgen -W "${models}" -- ${cur}) )
                fi
                return 0
                ;;
            *)
                ;;
        esac
    fi
    
    COMPREPLY=( $(compgen -W "${opts}" -- ${cur}) )
}

complete -F _vllm_completion vllm
complete -F _vllm_completion ./vllm

echo "ðŸ’¡ VLLM Manager bash completion loaded!"
echo "   Use tab completion with: ./vllm <tab>"
